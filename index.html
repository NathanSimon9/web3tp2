<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CHESS AI TACTICAL DASHBOARD</title>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
  
  <!-- MapLibre CSS -->
  <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css">
  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="./src/css/styles.css">
</head>
<body>
  <!-- Effets visuels VFX -->
  <div class="scanlines"></div>
  <div class="vignette"></div>
  <div class="grid-overlay"></div>
  <div class="glitch-overlay"></div>
  
  <!-- ŒIL ROUGE IRON MAN -->
  <div id="red-eye-container">
    <div class="red-eye">
      <div class="eye-outer">
        <div class="eye-middle">
          <div class="eye-inner">
            <div class="eye-pupil"></div>
          </div>
        </div>
      </div>
      <div class="eye-scan-beam"></div>
      <div class="eye-rings">
        <div class="eye-ring ring-1"></div>
        <div class="eye-ring ring-2"></div>
        <div class="eye-ring ring-3"></div>
      </div>
      <div class="eye-data">
        <span class="eye-text">SCANNING</span>
        <span class="eye-coords" id="eyeCoords">X:0 Y:0</span>
      </div>
    </div>
    <svg class="scan-lines-svg" width="100%" height="100%">
      <line id="scanLine1" class="scan-line-svg" x1="0" y1="0" x2="0" y2="0"/>
      <line id="scanLine2" class="scan-line-svg" x1="0" y1="0" x2="0" y2="0"/>
      <line id="scanLine3" class="scan-line-svg" x1="0" y1="0" x2="0" y2="0"/>
    </svg>
  </div>

  <!-- LAYOUT PRINCIPAL EN CSS GRID -->
  <div class="hud-container">
    
    <!-- ========== HEADER ========== -->
    <header class="hud-header">
      <div class="container-fluid h-100">
        <div class="row h-100 align-items-center">
          <!-- Logo Section -->
          <div class="col-4 d-flex align-items-center gap-3">
            <div class="logo-section">
              <div class="logo-icon">
                <i class="bi bi-cpu-fill"></i>
              </div>
              <span class="logo-text">CHESS<span class="accent">AI</span></span>
            </div>
            <div class="system-status d-none d-md-flex">
              <span class="status-indicator"></span>
              <span class="status-text">SYSTEM ONLINE</span>
            </div>
          </div>
          
          <!-- Timer Center -->
          <div class="col-4 text-center">
            <div class="mission-timer">
              <span class="timer-label">MISSION TIME</span>
              <span class="timer-value" id="missionTimer">00:00:00</span>
            </div>
          </div>
          
          <!-- Stats Right -->
          <div class="col-4 d-flex justify-content-end gap-2 gap-md-3">
            <div class="stat-item" data-bs-toggle="tooltip" title="CPU Usage">
              <i class="bi bi-cpu"></i>
              <span id="cpuUsage">47%</span>
            </div>
            <div class="stat-item" data-bs-toggle="tooltip" title="Active Targets">
              <i class="bi bi-geo-alt-fill"></i>
              <span id="activeTargets">15</span>
            </div>
            <div class="stat-item d-none d-lg-flex" data-bs-toggle="tooltip" title="Security Status">
              <i class="bi bi-shield-check"></i>
              <span>SECURE</span>
            </div>
            <button class="btn btn-sound" id="soundToggle" data-bs-toggle="tooltip" title="Toggle Sound">
              <i class="bi bi-volume-up-fill" id="soundIcon"></i>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- ========== PANNEAU GAUCHE - PIÈCES ZDOG ========== -->
    <aside class="left-panel">
      <div class="panel-header">
        <div class="panel-title">
          <i class="bi bi-bullseye"></i>
          <span>TACTICAL UNITS</span>
        </div>
        <div class="panel-controls">
          <button class="btn btn-sm btn-outline-cyan" id="refreshPieces">
            <i class="bi bi-arrow-clockwise"></i>
          </button>
        </div>
      </div>
      
      <div class="chess-grid">
        <!-- ROI - ZDog -->
        <div class="piece-card" data-piece="king">
          <div class="card-header d-flex justify-content-between">
            <span class="piece-name">ROI</span>
            <span class="badge bg-cyan">#K01</span>
          </div>
          <div class="piece-viewer" id="zdog-king"></div>
          <div class="card-stats">
            <div class="stat-row">
              <span>VALEUR</span>
              <div class="progress">
                <div class="progress-bar bg-cyan" style="width: 100%"></div>
              </div>
              <span class="stat-value">∞</span>
            </div>
            <div class="stat-row">
              <span>MOBILITÉ</span>
              <div class="progress">
                <div class="progress-bar bg-warning" style="width: 45%"></div>
              </div>
              <span class="stat-value">45%</span>
            </div>
          </div>
        </div>

        <!-- REINE - ZDog -->
        <div class="piece-card" data-piece="queen">
          <div class="card-header d-flex justify-content-between">
            <span class="piece-name">REINE</span>
            <span class="badge bg-cyan">#Q01</span>
          </div>
          <div class="piece-viewer" id="zdog-queen"></div>
          <div class="card-stats">
            <div class="stat-row">
              <span>VALEUR</span>
              <div class="progress">
                <div class="progress-bar bg-cyan" style="width: 90%"></div>
              </div>
              <span class="stat-value">9</span>
            </div>
            <div class="stat-row">
              <span>MOBILITÉ</span>
              <div class="progress">
                <div class="progress-bar bg-success" style="width: 95%"></div>
              </div>
              <span class="stat-value">95%</span>
            </div>
          </div>
        </div>

        <!-- FOU - ZDog -->
        <div class="piece-card" data-piece="bishop">
          <div class="card-header d-flex justify-content-between">
            <span class="piece-name">FOU</span>
            <span class="badge bg-cyan">#B01</span>
          </div>
          <div class="piece-viewer" id="zdog-bishop"></div>
          <div class="card-stats">
            <div class="stat-row">
              <span>VALEUR</span>
              <div class="progress">
                <div class="progress-bar bg-cyan" style="width: 30%"></div>
              </div>
              <span class="stat-value">3</span>
            </div>
            <div class="stat-row">
              <span>MOBILITÉ</span>
              <div class="progress">
                <div class="progress-bar bg-info" style="width: 70%"></div>
              </div>
              <span class="stat-value">70%</span>
            </div>
          </div>
        </div>

        <!-- CAVALIER - ZDog -->
        <div class="piece-card" data-piece="knight">
          <div class="card-header d-flex justify-content-between">
            <span class="piece-name">CAVALIER</span>
            <span class="badge bg-cyan">#N01</span>
          </div>
          <div class="piece-viewer" id="zdog-knight"></div>
          <div class="card-stats">
            <div class="stat-row">
              <span>VALEUR</span>
              <div class="progress">
                <div class="progress-bar bg-cyan" style="width: 30%"></div>
              </div>
              <span class="stat-value">3</span>
            </div>
            <div class="stat-row">
              <span>MOBILITÉ</span>
              <div class="progress">
                <div class="progress-bar bg-info" style="width: 65%"></div>
              </div>
              <span class="stat-value">65%</span>
            </div>
          </div>
        </div>

        <!-- TOUR - ZDog -->
        <div class="piece-card" data-piece="rook">
          <div class="card-header d-flex justify-content-between">
            <span class="piece-name">TOUR</span>
            <span class="badge bg-cyan">#R01</span>
          </div>
          <div class="piece-viewer" id="zdog-rook"></div>
          <div class="card-stats">
            <div class="stat-row">
              <span>VALEUR</span>
              <div class="progress">
                <div class="progress-bar bg-cyan" style="width: 50%"></div>
              </div>
              <span class="stat-value">5</span>
            </div>
            <div class="stat-row">
              <span>MOBILITÉ</span>
              <div class="progress">
                <div class="progress-bar bg-success" style="width: 80%"></div>
              </div>
              <span class="stat-value">80%</span>
            </div>
          </div>
        </div>

        <!-- PION - ZDog -->
        <div class="piece-card" data-piece="pawn">
          <div class="card-header d-flex justify-content-between">
            <span class="piece-name">PION</span>
            <span class="badge bg-cyan">#P01</span>
          </div>
          <div class="piece-viewer" id="zdog-pawn"></div>
          <div class="card-stats">
            <div class="stat-row">
              <span>VALEUR</span>
              <div class="progress">
                <div class="progress-bar bg-cyan" style="width: 10%"></div>
              </div>
              <span class="stat-value">1</span>
            </div>
            <div class="stat-row">
              <span>MOBILITÉ</span>
              <div class="progress">
                <div class="progress-bar bg-danger" style="width: 35%"></div>
              </div>
              <span class="stat-value">35%</span>
            </div>
          </div>
        </div>
      </div>
    </aside>

    <!-- ========== BARRE D'ÉVALUATION ========== -->
    <div class="evaluation-bar">
      <div class="bar-header">
        <i class="bi bi-bar-chart-fill"></i>
        <span>EVAL</span>
      </div>
      <div class="bar-container">
        <div class="bar-track">
          <div class="bar-fill white" id="barFillWhite"></div>
          <div class="bar-fill black" id="barFillBlack"></div>
          <div class="bar-center-line"></div>
        </div>
      </div>
      <div class="bar-value" id="barValue">0.0</div>
    </div>

    <!-- ========== ZONE CENTRALE - CARTE ========== -->
    <main class="main-content">
      <div id="carte"></div>
      <div class="map-overlay-info">
        <div class="scan-info">
          <div class="scan-target" id="scanTarget">MOSCOW</div>
          <div class="scan-coordinates" id="scanCoords">55.7558°N, 37.6173°E</div>
        </div>
      </div>
    </main>

    <!-- ========== PANNEAU DROIT ========== -->
    <aside class="right-panel">
      <!-- Toggle Switch avec Bootstrap -->
      <div class="btn-group w-100 mb-3" role="group">
        <input type="radio" class="btn-check" name="viewToggle" id="globalView" checked>
        <label class="btn btn-outline-cyan" for="globalView">
          <i class="bi bi-globe2"></i> GLOBAL
        </label>
        <input type="radio" class="btn-check" name="viewToggle" id="masterView">
        <label class="btn btn-outline-cyan" for="masterView">
          <i class="bi bi-person-badge"></i> MASTER
        </label>
      </div>

      <!-- Mode Global -->
      <div id="globalContainer">
        <!-- Section Analyse Tactique -->
        <div class="intel-section">
          <div class="section-header">
            <i class="bi bi-shield-exclamation"></i>
            <span>ANALYSE TACTIQUE</span>
          </div>
          <div class="tactical-data">
            <div class="row g-2">
              <div class="col-6">
                <div class="data-card threat">
                  <span class="data-label">Menaces</span>
                  <span class="data-value" id="threatCount">12</span>
                </div>
              </div>
              <div class="col-6">
                <div class="data-card opportunity">
                  <span class="data-label">Opportunités</span>
                  <span class="data-value" id="opportunityCount">8</span>
                </div>
              </div>
              <div class="col-6">
                <div class="data-card neutral">
                  <span class="data-label">Contrôle</span>
                  <span class="data-value" id="zoneControl">64%</span>
                </div>
              </div>
              <div class="col-6">
                <div class="data-card success">
                  <span class="data-label">Défense</span>
                  <span class="data-value">OPTIMAL</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Graphique ChartJS -->
        <div class="intel-section">
          <div class="section-header">
            <i class="bi bi-graph-up-arrow"></i>
            <span>PERFORMANCE ELO</span>
          </div>
          <div class="chart-container">
            <canvas id="eloChart"></canvas>
          </div>
        </div>

        <!-- Graphique Radar ChartJS -->
        <div class="intel-section">
          <div class="section-header">
            <i class="bi bi-activity"></i>
            <span>ACTIVITÉ RÉSEAU</span>
          </div>
          <div class="chart-container small">
            <canvas id="activityChart"></canvas>
          </div>
        </div>

        <!-- Liste des cibles -->
        <div class="intel-section">
          <div class="section-header">
            <i class="bi bi-crosshair"></i>
            <span>CIBLES GLOBALES</span>
          </div>
          <div class="target-list" id="targetList">
            <!-- Dynamiquement rempli par JS -->
          </div>
        </div>
      </div>

      <!-- Mode Master Profile -->
      <div class="master-profile d-none" id="masterProfile">
        <div class="profile-header">
          <div class="profile-avatar" id="profileAvatar"></div>
          <div class="profile-info">
            <h2 class="profile-name" id="profileName">GARRY KASPAROV</h2>
            <p class="profile-title" id="profileTitle">World Champion</p>
            <p class="profile-location">
              <i class="bi bi-geo-alt"></i>
              <span id="profileLocation">MOSCOW, RUSSIA</span>
            </p>
          </div>
        </div>

        <div class="profile-stats row g-2">
          <div class="col-4">
            <div class="profile-stat">
              <span class="stat-label">ELO</span>
              <span class="stat-number" id="profileElo">2851</span>
            </div>
          </div>
          <div class="col-4">
            <div class="profile-stat">
              <span class="stat-label">PEAK</span>
              <span class="stat-number" id="profileYear">1999</span>
            </div>
          </div>
          <div class="col-4">
            <div class="profile-stat">
              <span class="stat-label">TITLES</span>
              <span class="stat-number" id="profileTitles">15</span>
            </div>
          </div>
        </div>

        <!-- Radar Chart pour les skills -->
        <div class="profile-radar">
          <canvas id="radarChart"></canvas>
        </div>
      </div>
    </aside>

    <!-- ========== BARRE DU BAS ========== -->
    <footer class="hud-footer">
      <div class="container-fluid h-100">
        <div class="row h-100 align-items-center">
          <div class="col-8">
            <div class="notification" id="notification">
              <i class="bi bi-info-circle-fill"></i>
              <span>Système initialisé • Tous les modules opérationnels</span>
            </div>
          </div>
          <div class="col-4 d-flex justify-content-end gap-2">
            <span class="footer-stat">
              <i class="bi bi-hdd-network"></i>
              <span id="networkStatus">CONNECTED</span>
            </span>
            <span class="footer-stat">
              <i class="bi bi-clock"></i>
              <span id="currentTime">--:--:--</span>
            </span>
          </div>
        </div>
      </div>
    </footer>
  </div>

  <!-- Bootstrap Modal pour les détails -->
  <div class="modal fade" id="pieceModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark-panel">
        <div class="modal-header border-cyan">
          <h5 class="modal-title text-cyan">
            <i class="bi bi-info-circle"></i>
            <span id="modalPieceName">Détails de la pièce</span>
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div id="modalPieceViewer" style="height: 200px;"></div>
          <div class="piece-description mt-3" id="modalPieceDescription"></div>
        </div>
        <div class="modal-footer border-cyan">
          <button type="button" class="btn btn-outline-cyan" data-bs-dismiss="modal">Fermer</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- MapLibre -->
  <script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  
  <!-- Anime.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.2/anime.min.js"></script>
  
  <!-- Three.js + Loaders pour OBJ/MTL -->
  <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
      }
    }
  </script>
  
  <!-- Tone.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
  
  <!-- Custom Scripts -->
  <script src="./src/js/vfx.js"></script>
  <script src="./src/js/bootstrap.js"></script>
  <script src="./src/js/animejs.js"></script>
  <script src="./src/js/chartjs.js"></script>
  <script src="./src/js/maplibre.js"></script>
  <script type="module" src="./src/js/zdog.js"></script>
  <script src="./src/js/tonejs.js"></script>
</body>
</html>
